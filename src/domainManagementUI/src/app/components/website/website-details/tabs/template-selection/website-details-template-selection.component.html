<div class="flex flex-container tab">
  
  <div class="template_mode"> 
    <h5>Select a Template For This Website</h5>
    <div class="text-muted">
      Select your method to select a template
    </div>
    <div>
      <mat-radio-group
        aria-labelledby="template-selection-radio-group"
        class="example-radio-group"
        [(ngModel)]="wdTabSvc.templateSelectinoMethod">
        <mat-radio-button class="template-selection-radio-button" value="upload">
          Upload from zip
        </mat-radio-button>
        <mat-radio-button class="template-selection-radio-button" value="template_selection">
          Select from templates
        </mat-radio-button>
      </mat-radio-group>
    </div>
  </div>

  <div class="template_upload_section" *ngIf="wdTabSvc.templateSelectinoMethod === 'upload'"> 
    <button
      class="all_tab_option_button"
      mat-raised-button
      color="primary"
      (click)="uploadWebsite()"
    >
      Upload
  </button>
  </div>

  <div class="template_selection_section"  *ngIf="wdTabSvc.templateSelectinoMethod === 'template_selection'">
    <h5>Select a Template Base</h5>
    <div class="text-muted">
      Select a template base that will be used to generate your website.
    </div>

    <div class="search-bar flex">
      <mat-form-field class="w-100" appearance="outline">
        <mat-label>Search</mat-label>
        <input
          [(ngModel)]="search_input"
          (keyup)="filterList($event.target.value)"
          matInput
          placeholder="Search"
        />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
    <mat-table [dataSource]="templateList" matSort class="mb-5">
      <!-- Template Name -->
      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >Template Name</mat-header-cell
        >
        <mat-cell
          *matCellDef="let row"
          (click)="displayTemplate(row.s3_url)"
          >{{ row.name }}</mat-cell
        >
      </ng-container>

      <!-- Created By -->
      <!-- <ng-container matColumnDef="created_by">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >Created By</mat-header-cell
        >
        <mat-cell
          *matCellDef="let row"
          (click)="displayTemplate(row.s3_url)"
          >{{ row.uploaded_by }}</mat-cell
        >
      </ng-container> -->

      <!-- Created Date -->
      <ng-container matColumnDef="created_date">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >Created Date
        </mat-header-cell>
        <mat-cell
          *matCellDef="let row"
          (click)="displayTemplate(row.s3_url)"
          >{{ row.created | date: "MM/dd/yy" }}</mat-cell
        >
      </ng-container>

      <!-- Select Template -->
      <ng-container matColumnDef="selected_template">
        <mat-header-cell *matHeaderCellDef mat-sort-header>
          Selected Template
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
          <button
            *ngIf="row.selected"
            class="selected_button"
            mat-raised-button
            color="accent"
            class="flex"
            (click)="deSelectTemplate()"
          >
            Selected
          </button>
          <button
            *ngIf="!row.selected"
            mat-raised-button
            color="primary"
            class="flex"
            (click)="selectTemplate(row)"
          >
            Select
          </button>
        </mat-cell>
      </ng-container>

      <!-- Header Info -->
      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row
        class="table-row cursor-pointer"
        *matRowDef="let row; columns: displayedColumns"
      ></mat-row>
    </mat-table>

    <div *ngIf="safeURL" class="iframe_container">
      <div class="button_contianer">
        <button mat-button color="primary" (click)="openInNewTab()">
          <mat-icon>fullscreen</mat-icon>
        </button>
      </div>
      <iframe [src]="safeURL" height="100%" width="100%"></iframe>
    </div>
    <div style="margin-top: 2em" *ngIf="wdTabSvc.template_selection_form.valid" [formGroup]="attributeForm">
    <h5>Assing the Templates Attributes</h5>
    <!-- ATTRIBUTES -->
      <div class="text-muted">
        Assign the attributes that will be used to populate the fields within your
        selected template
      </div>
      <div
        class="flex flex-row"
        *ngFor="let attribute of wdTabSvc.attribueList; let i; index"
      >
        <mat-form-field style="width: 20em" appearance="outline">
          <mat-label>{{ attribute.key | titlecase}}</mat-label>
          <input
            matInput
            trim="blur"
            type="text"
            formControlName="{{ attribute.key }}"
            placeholder=" Type Attribute Here"
          />
        </mat-form-field>
      </div>
    </div>
    <!-- <div class="flex-row flex-end mt-4">
      <button mat-raised-button color="primary" class="flex" (click)="create()">
        Create
      </button>
    </div> -->

    <div class="flex-row flex-end mt-4">
      <!-- <button
        mat-raised-button
        color="primary"
        class="flex"
        (click)="nextTab()"
        [disabled]="!this.wdTabSvc.template_selection_form.valid"
      >
        Next
      </button> -->
      <button
        mat-raised-button
        color="primary"
        class="flex"
        (click)="createWebsiteHTML()"
        [disabled]="!attributeForm.valid"
      >
        Create Website HTML
      </button>
    </div>
  </div>
</div>
